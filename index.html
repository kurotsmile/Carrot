<html lang="en-US" class="dark">
<head>
    <title>Carrot Store</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
    <meta name="theme-color" media="(prefers-color-scheme: dark)"  content="black">
    <meta property="og:title" content="Carrot Store">
    <meta property="og:description" content="Carrot Store is an app store that introduces my gadgets and games to everyone in the world. These add-ons are all resources that I use in my apps, I don't want to waste them so I share them through this app store">
    <link rel="shortcut icon" href="images/favicon.ico" / type="images/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css?ver=1.2">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/js-snackbar.min.css" />
    <link href="fontawesome6.4.0/css/fontawesome.css" rel="stylesheet">
    <link href="fontawesome6.4.0/css/brands.css" rel="stylesheet">
    <link href="fontawesome6.4.0/css/solid.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-message-box@3.2.2/dist/messagebox.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />
    <link rel="manifest" href="manifest.json?ver=1.8" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5388516931803092" crossorigin="anonymous"></script>
</head>

<body>
    <header class="head">
        <div class="logo border-bottom">
            <img id="logo_carrot" class="w-100" src="images/logo.jpg" alt="Carrot Store" />
            <a class="navbar-toggler d-block d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><i class="bi fa-solid fa-bars"></i></a>
        </div>
        <div id="navbarNav" class="navcol pt-0 d-none d-lg-block overflow-auto">
            <ul>
                <li id="btn_home" class="border-bottom btn-menu"><i class="fa-solid fa-home fs-6 me-2"></i> <lang class="lang" key_lang="home">Home</lang></li>
                <li id="btn_all_app" class="border-bottom btn-menu"><i class="fa-solid fa-mobile bi fs-6 me-2"></i> <i class="bi fs-6  bi-google-play"></i> <lang class="lang" key_lang="app">Applications</lang></li>
                <li id="btn_all_game" class="border-bottom btn-menu"><i class="fa-solid fa-gamepad bi me-2 fs-6"></i> <lang class="lang" key_lang="game">Games</lang></li>
                <li id="btn_address_book" class="border-bottom btn-menu"><i class="fa-solid fa-address-book fs-6 me-2"></i> <lang class="lang" key_lang="phone_book">Phone book</lang></li>
                <li id="btn_list_music" class="border-bottom btn-menu"><i class="fa-solid fa-music fs-6 me-2"></i> Music</li>
                <li id="btn_audio" class="border-bottom btn-menu"><i class="fa-solid fa-guitar fs-6 me-2"></i> Instrumental music</li>
                <li id="btn_wallpapers" class="border-bottom btn-menu"><i class="fa-solid fa-image fs-6 me-2"></i> <lang class="lang" key_lang="wallpaper">Wallpapers</lang></li>
                <li id="btn_all_icon" class="border-bottom btn-menu"><i class="fa-solid fa-face-smile fs-6 me-2"></i> <lang class="lang" key_lang="icon">Icon</lang></li>
                <li id="btn_privacy_policy" class="border-bottom btn-menu"><i class="fa-sharp fa-solid fa-building-shield fs-6 me-2"></i> <lang class="lang" key_lang="privacy_policy">Privacy Policy</lang></li>
                <li id="btn_about_us" class="border-bottom btn-menu"><i class="fa-solid fa-heart fs-6 me-2"></i> <lang class="lang" key_lang="about_us">About Us</lang></li>
                <li id="btn_model_site" class="border-bottom btn-menu"><i class="fa-solid fa-window-maximize fs-6 me-2"></i> Development mode</li>

                <li class="btn-group dropup border-bottom dev btn-menu">
                    <div type="button" class="dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="fa-solid fa-add fs-6 me-2"></i> Add Obj
                    </div>
                    <div class="dropdown-menu">
                        <div class="dropdown-item btn-menu" id="btn_add_app" role="button"><i class="fa-solid fa-add fs-6 me-2"></i> Add App</div>
                        <div class="dropdown-item btn-menu" id="btn_add_music" role="button"><i class="fa-solid fa-circle-plus fs-6 me-2"></i> Add Music</div>
                        <div class="dropdown-item btn-menu" id="btn_add_icon" role="button"><i class="fa-solid fa-add fs-6 me-2"></i> Add Icon</div>
                        <div class="dropdown-item btn-menu" id="btn_add_wallpaper" role="button"><i class="fa-solid fa-add fs-6 me-2"></i> Add Background</div>
                        <div class="dropdown-item btn-menu" id="btn_add_lang" role="button"><i class="fa-solid fa-add fs-6 me-2"></i> Add Lang</div>
                        <div class="dropdown-item btn-menu" id="btn_add_avatar" role="button"><i class="fa-solid fa-square-plus fs-6 me-2"></i> Add Avatar</div>
                    </div>
                </li>

                <li class="btn-group dropup border-bottom dev btn-menu">
                    <div type="button" class="dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="fa-solid fa-rotate fs-6 me-2"></i> Backup and Sync
                    </div>

                    <div class="dropdown-menu">
                        <div class="dropdown-item btn-menu" id="btn_download_json" role="button"><i class="fa-solid fa-download fs-6 me-2"></i> Export Collection</div>
                        <div class="dropdown-item btn-menu" id="btn_import_json_url" role="button"><i class="fa-solid fa-file-import fs-6 me-2"></i> Import Collection (Url)</div>
                        <div class="dropdown-item btn-menu" id="btn_import_json_file" role="button"><i class="fa-solid fa-file-import fs-6 me-2"></i> Import Collection (File)</div>
                        <div class="dropdown-item btn-menu" id="btn_download_json_doc" role="button"><i class="fa-solid fa-file-lines fs-6 me-2"></i> Export Doc</div>
                        <div class="dropdown-item btn-menu" id="btn_import_json_doc" role="button"><i class="fa-solid fa-file-lines fs-6 me-2"></i> Import Doc (Url)</div>
                    </div>
                </li>

                <li class="btn-group dropup border-bottom dev btn-menu">
                    <div type="button" class="dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="fa-solid fa-language fs-6 me-2"></i> Language Data
                    </div>

                    <div class="dropdown-menu">
                        <div class="dropdown-item btn-menu" id="btn_setting_lang_app" role="button"><i class="fa-solid fa-language fs-6 me-2"></i> Lang all app</div>
                        <div class="dropdown-item btn-menu" id="btn_setting_lang_ailover" role="button"><i class="fa-solid fa-language fs-6 me-2"></i> Lang Ai Lover</div>
                        <div class="dropdown-item btn-menu" id="btn_setting_lang_web" role="button"><i class="fa-solid fa-language fs-6 me-2"></i> Lang web</div>
                    </div>
                </li>

                <li class="btn-group dropup border-bottom dev btn-menu">
                    <div type="button" class="dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="fa-brands fa-rocketchat fs-6 me-2"></i> Ai Lover
                    </div>

                    <div class="dropdown-menu">
                        <div class="dropdown-item btn-menu" id="btn_ai_lover_all_chat" role="button"><i class="fa-brands fa-rocketchat fs-6 me-2"></i> Chat Ai Lover</div>
                        <div class="dropdown-item btn-menu" id="btn_block_chat" role="button"><i class="fa-solid fa-shield-halved fs-6 me-2"></i> Block Key</div>
                        <div class="dropdown-item btn-menu" id="btn_user_avatar" role="button"><i class="fa-solid fa-image fs-6 me-2"></i> User Avatar</div>
                    </div>
                </li>

                <li id="btn_mode_host" class="border-bottom btn-menu dev"><i class="fa-solid fa-dev fs-6 me-2"></i> Localhost</li>
                <li id="btn_version_data" class="border-bottom btn-menu dev"><i class="fa-regular fa-code-compare fs-6 me-2"></i> Version</li>
                <li id="btn_code_js" class="border-bottom btn-menu dev"><i class="fa-regular fa-code fs-6 me-2"></i> Code Editer</li>
            </ul>
        </div>
    </header>
    <div class="main-content">
        <div class="nav-bar sticky-top-xl bg-white shadow-sm w-100 p-3">
            <div class="row">
                <div class="col-md-5">
                    <div class="input-group mb-0">
                        <div id="txt_recognition" class="form-control border-end-0 mb-0 d-none"><i class="fa-solid fa-voicemail"></i> <span id="txt_recognition_msg" class="text-primary">Speak into the microphone to search</span></div>
                        <input id="box_input_search" type="text" class="form-control border-end-0 mb-0" placeholder="Search Apps" aria-label="Recipient's username" aria-describedby="basic-addon2">
                        <span class="input-group-text sit border-start-0" id="basic-addon2"><i class="fa-sharp fa-solid fa-magnifying-glass"></i></span>
                        <span role="button" class="input-group-text sit border-start-0" id="btn_recognition"><i class="fa-solid fa-microphone"></i></span>
                    </div>
                </div>
                <div class="col-md-7 text-end">


                    <div class="dropdown pt-2 d-inline">
                        <a id="btn_login" class="btn btn-small btn-light cpfs-8">
                            <i class="fa-solid fa-user"></i> <lang class="lang" key_lang="login">Login</lang>
                        </a>

                        <a id="btn_acc_info" class="btn btn-small btn-light cpfs-8 dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="true">
                            <img id="acc_info_avatar" style="width: 20px;height: 20px;" src="images/avatar_default.png"/> <span id="acc_info_name">User name</span>
                        </a>

                        <ul class="dropdown-menu" id="menu_account">
                            <li><a class="dropdown-item" href="#"><i class="fa-solid fa-circle-info"></i> <l class="lang" key_lang="acc_info">Edit Info</l></a></li>
                            <li><a id="btn_logout" class="dropdown-item" href="#" > <i class="fa-solid fa-right-from-bracket"></i> <l class="lang" key_lang="logout">Logout</l></a></li>
                        </ul>
                    </div>

                    <a id="btn_change_lang" class="btn btn-small btn-light cpfs-8 d-inline">
                        <i class="fa-solid fa-globe"></i> <lang class="lang" key_lang="select_lang">Change Language</lang> <span class="fs-8 text-warning" id="key_lang">en</span>
                    </a>

                </div>
            </div>
        </div>
        <div id="main_contain" class="section-container p-2 p-xl-4">
            <div class="row m-0">
                Have a nice day!
            </div>
        </div>

        <div class="section-container p-2 p-xl-4">
            <div class="row m-0">
                <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-5388516931803092" data-ad-slot="3178591165"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>
    </div>

    <script src="assets/js/jquery-3.2.1.min.js"></script>
    <script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/popper.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/plugins/scroll-fixed/jquery-scrolltofixed-min.js"></script>
    <script src="assets/plugins/testimonial/js/owl.carousel.min.js"></script>
    <script src="assets/js/script.js"></script>
    <script src="assets/js/js-snackbar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-message-box@3.2.2/dist/messagebox.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, collection, addDoc, setDoc, doc, getDoc, query, where, getDocs, deleteDoc, connectFirestoreEmulator,disableNetwork } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";
        import {CodeJar} from "https://medv.io/codejar/codejar.js";
        
        var db;
        var carrot=new Carrot_Site();
        var app;

        carrot.setup_sever_db=()=>{
            carrot.log("setup_sever_db");
            if(app==null) app = initializeApp(carrot.firebaseConfig_mainhost);
            db = getFirestore();
            if (carrot.is_localhost) connectFirestoreEmulator(db,'localhost', 8082);
            if(db==null) carrot.show_error_connect_sever();
        }

        carrot.setup_sever_db();

        carrot.set_doc=(s_collection,s_document,data)=>{
            carrot.log("Set doc: collection:" + s_collection+" document:"+s_document);
            setDoc(doc(collection(db,s_collection),s_document),data);
        }

        carrot.get_doc=async (s_collection,s_id_document,act_done)=>{
            carrot.log("Get doc: collection:" + s_collection+" document:"+s_id_document);
            const dataRef = doc(db, s_collection, s_id_document);
            const dataSnap = await getDoc(dataRef);
            if (dataSnap.exists()) {
                var data_obj = dataSnap.data();
                data_obj["id"]=dataSnap.id;
                act_done(data_obj,carrot);
            } else {
                act_done(null,carrot);
            }
        }

        carrot.get_list_doc=async(s_collection,act_done)=>{
            var q = query(collection(db, s_collection));
            var queryListObj = await getDocs(q);
            if(queryListObj.docs.length>0){
                var obj_data=Object();
                queryListObj.forEach((doc) => {
                    obj_data[doc.id]=JSON.stringify(doc.data());
                });
                act_done(obj_data,carrot);
            }else{
                act_done(null,carrot);
            }
        }

        async function show_list_by_collection(collection_name) {
            var q = query(collection(db, collection_name));
            var querySnapshot = await getDocs(q);
            var t = "<table>";
            querySnapshot.forEach(doc => {
                var data_doc = doc.data();
                t += "<tr>";
                $.each(data_doc, function (k, v) {
                    t += "<td>" + k + "</td><td>" + v + "</td>";
                });
                t += "</tr>";
            });
            t += "</table>";
            $("#all_app").html(t);
        }

        $("#logo_carrot").on("contextmenu", function () { carrot.act_mode_dev(); return false; });
        $("#btn_download_json").click(function () {download_json();});
        $("#btn_code_js").click(function(){carrot.show_editor_code_js();});
        $("#btn_recognition").click(function(){carrot.start_recognition();});
        $("#btn_import_json_url").click(function () {
            var url_json = prompt("Enter url json", "Enter url");
            if (url_json != null) {
                $.ajax(url_json, {
                    success: function (data) {
                        carrot.import_json_by_data(data);
                    }
                });
            };
        });
        $("#btn_add_music").click(function(){carrot.music.show_add_or_edit_music(null,carrot.act_done_add_or_edit)});

        $(".btn-menu").click(function () {
            $(".btn-menu").removeClass("active");
            $(".btn-menu i").removeClass("fa-bounce");
            $(this).addClass("active");
            $(this).find("i").addClass("fa-bounce");
            var id_fun = $(this).attr("id");

            if (id_fun == "btn_address_book") carrot.show_all_phone_book();
            if (id_fun == "btn_all_icon") carrot.show_all_icon();
            if (id_fun == "btn_wallpapers") show_all_wallpaper();
            if (id_fun == "btn_home"||id_fun=='logo_carrot') carrot.show_home();
            if(id_fun=="btn_list_music") carrot.music.show_list_music();
            if (id_fun == "btn_all_app") { 
                carrot.show_all_app();
                carrot.change_title_page("Apps", "?p=all_app","app");
            };

            if (id_fun == "btn_all_game") { 
                carrot.show_all_game();
                carrot.change_title_page("Games", "?p=game","game");
            };

            if (id_fun == "btn_about_us") {
                $("#main_contain").load(carrot.get_url()+"/about_us/" + carrot.lang+".html?ver="+carrot.version["page"]);
                carrot.change_title_page("About Us", "?p=about_us","about_us");
            };
            if (id_fun == "btn_privacy_policy") {
                $("#main_contain").load(carrot.get_url()+"/privacy_policy/" + carrot.lang+".html?ver="+carrot.version["page"]);
                carrot.change_title_page("Privacy Policy", "?p=privacy_policy","privacy_policy");
            };
            if(id_fun=="btn_mode_host") carrot.change_host_connection();
            if(id_fun=="btn_model_site") carrot.change_mode_site();
            if(id_fun=="btn_add_app") carrot.show_box_add_or_edit_app(null,carrot.act_done_add_or_edit);
            if(id_fun=='btn_add_icon') carrot.show_box_add_or_edit_icon(null,carrot.act_done_add_or_edit);
            if(id_fun=='btn_add_wallpaper') show_box_add_or_edit_wallpaper(null,carrot.act_done_add_or_edit);
            if(id_fun=='btn_add_lang') show_box_add_or_edit_lang(null,carrot.act_done_add_or_edit);
            if(id_fun=='btn_version_data') carrot.show_edit_version_data_version(act_done_edit_version_data_version);
            if(id_fun=='btn_ai_lover_all_chat') carrot.ai_lover.show_all_chat_ai_lover();
            if(id_fun=='btn_block_chat') carrot.show_all_block_chat_by_lang();
            if(id_fun=='btn_download_json_doc') download_json_doc();
            if(id_fun=='btn_import_json_doc') carrot.show_import_json_box(null);
            if(id_fun=='btn_import_json_file') carrot.show_import_json_file();
            if(id_fun=='btn_setting_lang_app') carrot.show_setting_lang_by_key(carrot.lang,'lang_app');
            if(id_fun=='btn_setting_lang_ailover') carrot.show_setting_lang_by_key(carrot.lang,'lang_app_ai_lover');
            if(id_fun=='btn_setting_lang_web') carrot.show_setting_lang_by_key(carrot.lang,'lang_web');
        });

        carrot.show_setting_lang_by_key=async(s_key_lang_change="",s_collection)=>{    
                carrot.ai_lover.setting_lang_change=s_key_lang_change;
                const langRef_tag = doc(db, s_collection, "en");
                const langSnap_tag = await getDoc(langRef_tag);
                var data_obj_lang_tag=new Object();
                if (langSnap_tag.exists()) {
                    data_obj_lang_tag = langSnap_tag.data();
                    data_obj_lang_tag["id"]=langSnap_tag.id;
                }

                const langRef_change = doc(db, s_collection, s_key_lang_change);
                const langSnap_change = await getDoc(langRef_change);
                var data_obj_lang_change=new Object();
                if (langSnap_change.exists()) {
                    data_obj_lang_change = langSnap_change.data();
                    data_obj_lang_change["id"]=langSnap_change.id;
                }

                carrot.ai_lover.setting_lang_collection=s_collection;
                carrot.ai_lover.show_setting_lang(data_obj_lang_tag,data_obj_lang_change);
        }

        carrot.ai_lover.show_all_chat_ai_lover=async (s_lang="")=>{
            if(s_lang=="") s_lang=carrot.lang;
            carrot.ai_lover.setting_lang_change=s_lang;
            var querySnapshot = await getDocs(query(collection(db, "chat-"+s_lang),where("status","==","pending")));
            carrot.ai_lover.show_all_chat(querySnapshot);
        }

        carrot.show_all_block_chat_by_lang=async (s_key_lang='')=>{
            if(s_key_lang=='') s_key_lang=carrot.lang;
            const appSnap = await getDoc(doc(db, "block",s_key_lang));
            if (appSnap.exists()) {
                var data_list_key_block=appSnap.data();
                data_list_key_block["lang"]=appSnap.id;
                carrot.ai_lover.show_list_block_chat(data_list_key_block);
            } else {
                $.MessageBox("Chưa có danh sách từ cấm!");
                var data_list_key_block=new Object();
                data_list_key_block["lang"]=s_key_lang;
                data_list_key_block["chat"]=Array("new_key_block");
                carrot.ai_lover.show_list_block_chat(data_list_key_block);
            }
        }

        carrot.act_done_add_or_edit=(data)=>{
            carrot.log("act_done_add_or_edit");
            var act_msg_success=data.act_msg_success;
            var db_collection=data.db_collection;
            var db_doc=data.db_doc;
            var act_name_before=data.act_name_before;

            delete(data.act_msg_success);
            delete(data.db_collection);
            delete(data.db_doc);
            delete(data.act_name_before);
            setDoc(doc(collection(db,db_collection),data[db_doc]), data);
            if(db_collection=="app") carrot.delete_obj_app();
            if(db_collection=="icon") carrot.delete_obj_icon();
            $.MessageBox(act_msg_success);
            if(act_name_before!=null&&act_name_before!='') eval(act_name_before + "()");
        }

        function act_done_edit_version_data_version(data){
            setDoc(doc(collection(db, "setting_web"),"version"), data);
            $.MessageBox("Change version data site success!");
            carrot.check_version_data();
        }

        async function show_all_wallpaper(){
            var q = query(collection(db, "background"));
            var querySnapshot = await getDocs(q);
            show_list_background(querySnapshot);
            carrot.change_title_page("Wallpapers", "?p=wallpapers","wallpapers");
        }

        carrot.import_json_by_data=(data)=>{
            var name_collection = data.collection;
            var all_item = data.all_item;
            var cr_data = collection(db, name_collection);
            $.each(all_item, function (index, d) {
                var doc_id = d["id_import"];
                delete d["id_import"];
                setDoc(doc(cr_data, doc_id), d);
            });
            $.MessageBox("Import Success!");
        }

        $("#btn_login").click(function () {
            $.MessageBox({
                message: "<b><i class='fa-solid fa-key'></i> "+carrot.l('login')+"</b>",
                input: {
                    usernames: {type: "text",label: carrot.l("phone"),title: "Enter Your Phone"},
                    password: {type: "password",label:carrot.l("password"),title: "Type password here"},
                    dummy_caption: {type: "caption",message: carrot.l("login_tip")}
                },
                top: "auto",
                buttonFail:carrot.l("cancel"),
                buttonDone  : {login:{text:carrot.l('login'),keyCode: 12},register:{text:carrot.l("register"),keyCode: 13}},
            }).done(function(data,button) {
                var username=data.usernames;
                var password=data.password;
                if(button=='login') check_user_login(username,password);
                if(button=='register') carrot.show_box_add_or_edit_phone_book(null,carrot.act_done_add_or_edit);
            });
        });

        $("#btn_logout").click(function(){carrot.user_logout();});
        $("#btn_user_avatar").click(async function(){
            var q = query(collection(db, "user-avatar"));
            var queryUserAvatar = await getDocs(q);
            if(queryUserAvatar.docs.length>0){
                carrot.ai_lover.show_list_avatar(queryUserAvatar.docs);
            }
        });
        $("#btn_add_avatar").click(function(){carrot.ai_lover.show_box_add_or_edit_avatar(null,carrot.act_done_add_or_edit);});

        async function check_user_login(username,password){
            var q = query(collection(db, "user-"+carrot.lang), where("phone", "==", username),where("password", "==", password));
            var querySnapshot = await getDocs(q);
            if(querySnapshot.docs.length>0){
                querySnapshot.forEach((doc) => {
                    carrot.set_user_login(doc.data());
                });
            }else{
                $.MessageBox("Đăng nhập thất bại!");
            }
        }

        carrot.act_del_obj=async (db_collection,db_doc_id)=>{
            await deleteDoc(doc(db, db_collection, db_doc_id));
            $.MessageBox("Delete object ('" + db_doc_id + "') Success!");
            if(db_collection=="app") carrot.delete_obj_app();
            if(db_collection=="icon") carrot.delete_obj_icon();
            if(carrot.id_page=="address_book") carrot.delete_obj_phone_book();
        }

        async function download_json() {
            var name_collection = prompt("Enter collection json", "Enter name collection");
            if (name_collection == "") return;
            var data_json = Object();
            data_json["all_item"] = Array();
            data_json["collection"] = name_collection;
            var q = query(collection(db, name_collection));
            var querySnapshot = await getDocs(q);
            querySnapshot.forEach((doc) => {
                var data_app = doc.data();
                data_app["id_import"] = doc.id;
                data_json.all_item.push(data_app);
            });

            var fileContents = JSON.stringify(data_json, null, 2);
            var fileName = name_collection + ".json";

            var pp = document.createElement('a');
            pp.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(fileContents));
            pp.setAttribute('download', fileName);
            pp.click();
        }

        function download_json_doc() {
            var name_collection = prompt("Enter collection", "Enter name collection");
            if(name_collection=="") return;
            var name_document = prompt("Enter document", "Enter document in collection");
            if (name_document== "") return;
            carrot.act_download_json_by_collection_and_doc(name_collection,name_document);
        }

        carrot.get_all_data_app=async()=>{
            carrot.log("get_all_data_app from sever");
            var q = query(collection(db, "app"));
            var querySnapshot_app = await getDocs(q);
            carrot.obj_app=Object();
            querySnapshot_app.forEach((doc) => {
                var data_app=doc.data();
                data_app["id"]=doc.id;
                carrot.obj_app[doc.id]=JSON.stringify(data_app);
            });
            carrot.save_obj_app();
            carrot.show_home();
        };

        carrot.get_all_data_phone_book=async()=>{
            carrot.log("get_all_data_phone_book from sever");
            var q = query(collection(db, "user-"+carrot.lang), where("status_share", "==", "0"));
            var queryListPhoneBook = await getDocs(q);
            carrot.obj_phone_book=Object();
            queryListPhoneBook.forEach((doc) => {
                var data_phone=doc.data();
                data_phone["id"]=doc.id;
                carrot.obj_phone_book[doc.id]=JSON.stringify(data_phone);
            });
            carrot.save_obj_phone_book();
            carrot.show_all_phone_book();
        }

        async function get_all_data_link_store() {
            carrot.log("get_all_data_link_store");
            carrot.list_link_store=Array();
            var q = query(collection(db, "link_store"));
            var querySnapshot_link_store = await getDocs(q);
            querySnapshot_link_store.forEach((doc) => {
                carrot.list_link_store.push(doc.data());
            });
            carrot.save_list_link_store();
        };

        async function get_all_data_lang() {
            var cr_lang = collection(db, "lang");
            var q = query(cr_lang);
            var querySnapshot_lang = await getDocs(q);
            carrot.list_lang=Array();
            querySnapshot_lang.forEach((doc) => {
                var lang_data = doc.data();
                lang_data["id"]=doc.id;
                carrot.list_lang.push(lang_data);
            });
            carrot.save_list_lang();
        };

        carrot.get_all_data_icon=async()=>{
            carrot.log("Get data icon to sever");
            carrot.obj_icon=new Object();
            var q = query(collection(db, "icon"));
            var querySnapshot = await getDocs(q);
            querySnapshot.forEach((doc) => {
                var data_icon=doc.data();
                data_icon["id"]=doc.id;
                carrot.obj_icon[doc.id]=JSON.stringify(data_icon);
            });
            carrot.save_obj_icon();
            carrot.show_all_icon_from_list_icon();
        }

        carrot.create_editor_js=()=>{
            CodeJar(document.querySelector('.editor'), hljs.highlightElement);
        }

        carrot.check_version_data=async()=>{
            carrot.log("check_version_data");
            try {
                var obj_version_cur =carrot.version;
                const verRef = doc(db, "setting_web","version");
                const verSnap = await getDoc(verRef);
                if (verSnap.exists()) {
                    var ver_data_new=verSnap.data();
                    if(ver_data_new.link_store!=obj_version_cur["link_store"]) get_all_data_link_store();
                    if(ver_data_new.lang_web!=obj_version_cur["lang_web"]) carrot.get_all_data_lang_web();
                    if(ver_data_new.app!=obj_version_cur["app"]) carrot.get_all_data_app();
                    if(ver_data_new.lang!=obj_version_cur["lang"]) get_all_data_lang();
                    carrot.set_version_data_cur(ver_data_new);
                    carrot.check_show_by_id_page();
                }else{
                    carrot.show_error_connect_sever();
                    carrot.check_show_by_id_page();
                }
            } catch (err) {
                if (err.response) {
                    carrot.show_error_connect_sever();
                    carrot.check_show_by_id_page();
                    carrot.log(err.message);
                    return err.response.data;
                } else if (err.request) {
                    carrot.show_error_connect_sever();
                    carrot.check_show_by_id_page();
                    carrot.log(err.message);
                    return err.request;
                } else {
                    carrot.show_error_connect_sever();
                    carrot.check_show_by_id_page();
                    carrot.log(err.message);
                    return err.message;
                }
            }
        }

        $(document).ready(function () {
            var lang_page=get_param_url("lang");
            if(lang_page!=null){
                if(lang_page!=carrot.lang){
                    carrot.lang_url=lang_page;
                    carrot.change_lang(lang_page);
                    carrot.get_all_data_lang_web();
                    carrot.check_show_by_id_page();
                }
            }
            carrot.check_version_data();
            carrot.load_data_lang_web();
            carrot.show_info_user_login_in_header();
        });
    </script>
    <script src="js/main.js?ver=1.10" type="text/javascript" class="emp_js" data-ver="1.6"></script>
    <script src="js/ai_lover.js?ver=1.10" type="text/javascript" class="emp_js" data-ver="1.6"></script>
    <script src="js/carrot_site.js?ver=1.10" type="text/javascript" class="emp_js" data-ver="1.6"></script>
    <script src="js/carrot_music.js?ver=1.10" type="text/javascript" class="emp_js" data-ver="1.6"></script>
    <link rel="stylesheet" href="highlight/styles/default.min.css"/>
    <script src="highlight/highlight.min.js"></script>
</body>
</html>